<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div class="mb-3">
    <label>Reference Number</label>
    <input class="form-control" formControlName="referenceNumber" />
  </div>

  <h5>Customers</h5>
  <div formArrayName="customers">
    <div *ngFor="let c of customers.controls; let i = index" [formGroupName]="i" class="mb-3">
      <input class="form-control mb-2" placeholder="Customer name" formControlName="name" />
      <input class="form-control" type="number" placeholder="Payment amount" formControlName="paymentAmount" />
    </div>
  </div>
  <button type="button" class="btn btn-sm btn-secondary mb-3" (click)="addCustomer()">Add Customer</button>

  <h5>Service Providers</h5>
  <div formArrayName="serviceProv">
    <div *ngFor="let s of serviceProv.controls; let j = index" [formGroupName]="j" class="mb-3">
      <input class="form-control mb-2" placeholder="Service description" formControlName="description" />
      <input class="form-control" type="number" placeholder="Cost amount" formControlName="costAmount" />
    </div>
  </div>
  <button type="button" class="btn btn-sm btn-secondary mb-3" (click)="addService()">Add Service</button>

  <button type="submit" class="btn btn-primary">Submit</button>
</form>

<!-- Result Display -->
<div *ngIf="result" class="mt-4">
  <h5>Summary</h5>
  <p><strong>Reference:</strong> {{ result.referenceNumber }}</p>
  <p><strong>Total Payments:</strong> {{
    result.customers?.reduce((total, c) => total + (c.paymentAmount || 0), 0)
  }}</p>
  <p><strong>Total Costs:</strong> {{
    result.serviceProv?.reduce((total, s) => total + (s.costAmount || 0), 0)
  }}</p>
  <p><strong>Profit:</strong> {{
    (result.customers?.reduce((total, c) => total + (c.paymentAmount || 0), 0) || 0)
      - (result.serviceProv?.reduce((total, s) => total + (s.costAmount || 0), 0) || 0)
  }}</p>
</div>
